<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>AI 프롬프트 설계 마법사</title>
    <!-- Tailwind CSS CDN -->
    <script src="https://cdn.tailwindcss.com"></script>
    <!-- Lucide Icons CDN -->
    <script src="https://unpkg.com/lucide@latest"></script>
    <style>
        @import url('https://fonts.googleapis.com/css2?family=Pretendard:wght@400;500;600;700&display=swap');
        
        body {
            font-family: 'Pretendard', sans-serif;
            background-color: #f8fafc;
            color: #1e293b;
            overflow-x: hidden;
            -webkit-font-smoothing: antialiased;
        }

        .wizard-step {
            display: none;
            animation: fadeIn 0.4s ease-out forwards;
            width: 100%;
        }

        .wizard-step.active {
            display: block;
        }

        @keyframes fadeIn {
            from { opacity: 0; transform: translateY(10px); }
            to { opacity: 1; transform: translateY(0); }
        }

        /* 텍스트에리어 공통 스타일 */
        .textarea-base {
            display: block !important;
            width: 100% !important;
            box-sizing: border-box !important;
            padding: 0.875rem 1rem !important; 
            @apply rounded-xl border border-slate-200 bg-white outline-none focus:ring-4 focus:ring-blue-500/10 focus:border-blue-500 transition-all text-lg leading-relaxed resize-none shadow-sm;
        }

        .progress-dot {
            @apply w-3 h-3 rounded-full transition-all duration-300;
        }

        .progress-dot.active {
            @apply bg-blue-600 ring-4 ring-blue-100;
        }

        .progress-dot.completed {
            @apply bg-blue-600;
        }

        .progress-dot.pending {
            @apply bg-slate-200;
        }

        ::-webkit-scrollbar { width: 6px; }
        ::-webkit-scrollbar-track { background: #f1f5f9; }
        ::-webkit-scrollbar-thumb { background: #cbd5e1; border-radius: 10px; }

        /* 커스텀 모달 스타일 */
        #confirmModal {
            display: none;
            background: rgba(15, 23, 42, 0.6);
            backdrop-filter: blur(4px);
        }
        #confirmModal.active {
            display: flex;
        }
    </style>
</head>
<body class="antialiased min-h-screen flex flex-col text-slate-800">

    <!-- 초기화 확인 모달 -->
    <div id="confirmModal" class="fixed inset-0 z-[100] items-center justify-center p-4">
        <div class="bg-white rounded-2xl shadow-2xl max-w-sm w-full p-6 transform transition-all border border-slate-100">
            <div class="flex items-center gap-3 mb-4 text-red-600">
                <i data-lucide="alert-triangle" class="w-6 h-6"></i>
                <h3 class="text-xl font-bold">내용 초기화</h3>
            </div>
            <p class="text-slate-600 mb-6 leading-relaxed text-sm">
                작성 중인 모든 내용과 저장된 데이터가 삭제됩니다. 처음 단계로 돌아가시겠습니까?
            </p>
            <div class="flex gap-3">
                <button onclick="closeModal()" class="flex-1 px-4 py-3 bg-slate-100 hover:bg-slate-200 text-slate-700 font-bold rounded-xl transition-all">
                    취소
                </button>
                <button onclick="resetWizard()" class="flex-1 px-4 py-3 bg-red-600 hover:bg-red-700 text-white font-bold rounded-xl transition-all">
                    초기화 실행
                </button>
            </div>
        </div>
    </div>

    <!-- 헤더 -->
    <header class="bg-white border-b border-slate-200 sticky top-0 z-50">
        <div class="max-w-4xl mx-auto px-6 py-4">
            <div class="flex items-center justify-between mb-4">
                <div class="flex items-center gap-2">
                    <div class="bg-blue-600 p-1.5 rounded-lg shadow-lg shadow-blue-100">
                        <i data-lucide="wand-2" class="text-white w-5 h-5"></i>
                    </div>
                    <span class="font-bold text-slate-900 tracking-tight">AI 프롬프트 설계 마법사</span>
                </div>
                <div class="flex items-center gap-3">
                    <div class="text-sm font-medium text-slate-400" id="stepIndicator">Step 1 of 6</div>
                    <button onclick="showModal()" class="text-xs bg-slate-100 hover:bg-red-50 hover:text-red-600 px-2 py-1 rounded-md text-slate-500 font-bold transition-all flex items-center gap-1 border border-slate-200">
                        <i data-lucide="refresh-ccw" class="w-3 h-3"></i>
                        초기화
                    </button>
                </div>
            </div>
            <!-- 진행 상태 바 -->
            <div class="flex items-center justify-between gap-2 relative">
                <div class="absolute h-0.5 bg-slate-100 w-full top-1/2 -translate-y-1/2 z-0"></div>
                <div id="progressBar" class="absolute h-0.5 bg-blue-600 transition-all duration-500 top-1/2 -translate-y-1/2 z-0" style="width: 0%"></div>
                
                <div class="progress-dot active z-10" data-step="1"></div>
                <div class="progress-dot pending z-10" data-step="2"></div>
                <div class="progress-dot pending z-10" data-step="3"></div>
                <div class="progress-dot pending z-10" data-step="4"></div>
                <div class="progress-dot pending z-10" data-step="5"></div>
                <div class="progress-dot pending z-10" data-step="6"></div>
            </div>
        </div>
    </header>

    <!-- 설문 입력 영역 -->
    <main class="flex-grow max-w-4xl mx-auto w-full px-6 py-12">
        <form id="wizardForm" class="w-full" onsubmit="return false;">
            
            <!-- Step 1: 역할 및 대상 -->
            <div class="wizard-step active w-full" id="step1">
                <div class="mb-8">
                    <h2 class="text-3xl font-bold text-slate-900 mb-2">1. 정체성과 독자 설정</h2>
                    <p class="text-slate-500 text-sm">대화의 주체인 AI의 역할과 이를 받아볼 대상을 정의합니다.</p>
                </div>
                <div class="space-y-10 w-full">
                    <div>
                        <label class="block font-bold text-slate-900 mb-2">AI에게 부여할 전문가의 역할(페르소나)을 구체적으로 입력해 주세요.</label>
                        <p class="text-xs text-slate-400 mb-3 uppercase tracking-wider">Expert Persona</p>
                        <textarea id="persona" class="textarea-base h-32" placeholder="예: 10년 경력의 비즈니스 전략가, 시니어 웹 개발자 등"></textarea>
                    </div>
                    <div>
                        <label class="block font-bold text-slate-900 mb-2">이 답변을 받아볼 대상과 그들의 전문 지식 수준은 어떠합니까?</label>
                        <p class="text-xs text-slate-400 mb-3 uppercase tracking-wider">Target Audience</p>
                        <textarea id="audience" class="textarea-base h-32" placeholder="예: 관련 지식이 부족한 일반인, 기술적 이해도가 높은 경영진 등"></textarea>
                    </div>
                    <div>
                        <label class="block font-bold text-slate-900 mb-2">답변 시 갖춰야 할 전문가다운 말투와 태도를 설정해 주세요.</label>
                        <p class="text-xs text-slate-400 mb-3 uppercase tracking-wider">Tone and Manner</p>
                        <textarea id="tone" class="textarea-base h-32" placeholder="예: 논리적이고 정중한 어조, 친절하고 고무적인 태도 등"></textarea>
                    </div>
                </div>
            </div>

            <!-- Step 2: 목표 및 프로세스 -->
            <div class="wizard-step w-full" id="step2">
                <div class="mb-8">
                    <h2 class="text-3xl font-bold text-slate-900 mb-2">2. 작업 목표와 수행 절차</h2>
                    <p class="text-slate-500 text-sm">수행할 작업의 본질과 이를 완수하기 위한 논리적 단계를 설계합니다.</p>
                </div>
                <div class="space-y-10 w-full">
                    <div>
                        <label class="block font-bold text-slate-900 mb-2">AI가 수행해야 할 가장 핵심적인 작업은 무엇입니까?</label>
                        <p class="text-xs text-slate-400 mb-3 uppercase tracking-wider">Core Action</p>
                        <textarea id="coreAction" class="textarea-base h-40" placeholder="예: 복잡한 보고서 핵심 요약, 효율적인 코드 리팩토링 등"></textarea>
                    </div>
                    <div>
                        <label class="block font-bold text-slate-900 mb-2">이 작업을 통해 얻고자 하는 구체적인 성과나 목표는 무엇입니까?</label>
                        <p class="text-xs text-slate-400 mb-3 uppercase tracking-wider">Ultimate Goal / KPI</p>
                        <textarea id="kpi" class="textarea-base h-32" placeholder="예: 즉시 실행 가능한 마케팅 플랜 도출, 오류가 없는 완성된 소스코드 등"></textarea>
                    </div>
                    <div>
                        <label class="block font-bold text-slate-900 mb-2">작업을 완료하기 위해 거쳐야 할 논리적인 단계와 검토 요소를 입력해 주세요.</label>
                        <p class="text-xs text-slate-400 mb-3 uppercase tracking-wider">Steps & Logic</p>
                        <textarea id="logicalSteps" class="textarea-base h-48" placeholder="1단계: 상황 분석, 2단계: 대안 제시 등 수행 절차를 작성하세요."></textarea>
                    </div>
                </div>
            </div>

            <!-- Step 3: 배경 및 제약 -->
            <div class="wizard-step w-full" id="step3">
                <div class="mb-8">
                    <h2 class="text-3xl font-bold text-slate-900 mb-2">3. 참고 자료와 제약 사항</h2>
                    <p class="text-slate-500 text-sm">정확한 답변을 위해 필요한 배경 지식과 반드시 지켜야 할 규칙을 설정합니다.</p>
                </div>
                <div class="space-y-10 w-full">
                    <div>
                        <label class="block font-bold text-slate-900 mb-2">AI가 참고할 핵심 데이터나 반드시 알아야 할 배경 맥락을 설명해 주세요.</label>
                        <p class="text-xs text-slate-400 mb-3 uppercase tracking-wider">Context & Reference</p>
                        <textarea id="context" class="textarea-base h-48" placeholder="참조할 문서 내용이나 현재 직면한 특수한 상황을 상세히 입력하세요."></textarea>
                    </div>
                    <div>
                        <label class="block font-bold text-slate-900 mb-2">정보의 최신성을 어떻게 유지하고 반영할지 기준을 설정해 주세요.</label>
                        <p class="text-xs text-slate-400 mb-3 uppercase tracking-wider">Recency Control</p>
                        <textarea id="recencyControl" class="textarea-base h-32" placeholder=""></textarea>
                    </div>
                    <div>
                        <label class="block font-bold text-slate-900 mb-2">답변 시 반드시 지켜야 할 규칙이나 절대 피해야 할 사항을 입력해 주세요.</label>
                        <p class="text-xs text-slate-400 mb-3 uppercase tracking-wider">Constraints</p>
                        <textarea id="constraints" class="textarea-base h-40" placeholder="예: 특정 브랜드 언급 금지, 전문 용어 설명 필수, 외부 도구 사용 금지 등"></textarea>
                    </div>
                </div>
            </div>

            <!-- Step 4: 출력 규격 -->
            <div class="wizard-step w-full" id="step4">
                <div class="mb-8">
                    <h2 class="text-3xl font-bold text-slate-900 mb-2">4. 출력 형식과 규격</h2>
                    <p class="text-slate-500 text-sm">결과물의 형태, 분량, 언어 등 시각적·구조적 규격을 확정합니다.</p>
                </div>
                <div class="space-y-10 w-full">
                    <div>
                        <label class="block font-bold text-slate-900 mb-2">어떤 형식으로 출력되기를 원하며, 반드시 포함해야 할 항목은 무엇입니까?</label>
                        <p class="text-xs text-slate-400 mb-3 uppercase tracking-wider">Format & Sections</p>
                        <textarea id="outputFormat" class="textarea-base h-40" placeholder="예: Markdown 표 형식, 요약-본문-결론 구조의 리포트 양식 등"></textarea>
                    </div>
                    <div>
                        <label class="block font-bold text-slate-900 mb-2">답변의 상세한 정도(심도)와 구체적인 분량 기준을 입력해 주세요.</label>
                        <p class="text-xs text-slate-400 mb-3 uppercase tracking-wider">Depth & Length</p>
                        <textarea id="outputDepth" class="textarea-base h-32" placeholder="예: 전문적인 심층 분석, A4 반 페이지 이내의 핵심 요약 등"></textarea>
                    </div>
                    <div>
                        <label class="block font-bold text-slate-900 mb-2">표기 언어와 시각적 스타일(이모지 등)에 대한 요구사항이 있습니까?</label>
                        <p class="text-xs text-slate-400 mb-3 uppercase tracking-wider">Language & Visuals</p>
                        <textarea id="visual" class="textarea-base h-32" placeholder="예: 한국어 사용, 가독성을 위해 불렛 포인트와 이모지 적극 활용 등"></textarea>
                    </div>
                </div>
            </div>

            <!-- Step 5: 추론 전략 -->
            <div class="wizard-step w-full" id="step5">
                <div class="mb-8">
                    <h2 class="text-3xl font-bold text-slate-900 mb-2">5. 사고 방식과 품질 강화</h2>
                    <p class="text-slate-500 text-sm">AI가 답변을 도출하는 논리적 사고 과정을 제어합니다.</p>
                </div>
                <div class="space-y-4 w-full">
                    <label class="flex items-center gap-5 p-6 bg-white border border-slate-200 rounded-2xl cursor-pointer hover:border-blue-500 transition-all w-full shadow-sm text-left">
                        <input type="checkbox" id="useCot" class="w-6 h-6 accent-blue-600">
                        <div class="flex flex-col">
                            <span class="font-bold text-lg text-slate-900">'생각의 사슬(CoT)' 기법 적용</span>
                            <span class="text-sm text-slate-400 italic font-medium">단계별 추론 과정을 상세히 보여주어 정답률을 높입니다.</span>
                        </div>
                    </label>
                    <label class="flex items-center gap-5 p-6 bg-white border border-slate-200 rounded-2xl cursor-pointer hover:border-blue-500 transition-all w-full shadow-sm text-left">
                        <input type="checkbox" id="useTot" class="w-6 h-6 accent-blue-600">
                        <div class="flex flex-col">
                            <span class="font-bold text-lg text-slate-900">'생각의 나무(ToT)' 기법 적용</span>
                            <span class="text-sm text-slate-400 italic font-medium">여러 대안을 스스로 비교 분석한 뒤 가장 적합한 결과를 도출합니다.</span>
                        </div>
                    </label>
                    <label class="flex items-center gap-5 p-6 bg-white border border-slate-200 rounded-2xl cursor-pointer hover:border-blue-500 transition-all w-full shadow-sm text-left">
                        <input type="checkbox" id="useSelfReview" class="w-6 h-6 accent-blue-600">
                        <div class="flex flex-col">
                            <span class="font-bold text-lg text-slate-900">자기 검증 단계 포함</span>
                            <span class="text-sm text-slate-400 italic font-medium">답변 후 스스로 논리적 오류나 사실 관계를 다시 점검합니다.</span>
                        </div>
                    </label>
                </div>
            </div>

            <!-- Step 6: 설계 완료 및 복사 -->
            <div class="wizard-step w-full" id="step6">
                <div class="text-center py-10">
                    <div class="w-20 h-20 bg-blue-100 text-blue-600 rounded-full flex items-center justify-center mx-auto mb-8 shadow-inner border border-blue-50">
                        <i data-lucide="check" class="w-10 h-10"></i>
                    </div>
                    <h2 class="text-3xl font-bold text-slate-900 mb-4">프롬프트 설계가 완료되었습니다!</h2>
                    <p class="text-slate-500 text-lg mb-10 max-w-md mx-auto">
                        최적화된 전문가용 프롬프트가 준비되었습니다. <br>아래 버튼을 눌러 결과물을 복사하세요.
                    </p>
                    
                    <div class="bg-amber-50 border border-amber-200 rounded-2xl p-6 mb-10 max-w-lg mx-auto flex items-start gap-4 text-left shadow-sm">
                        <div class="mt-1 text-amber-600">
                            <i data-lucide="help-circle" class="w-6 h-6"></i>
                        </div>
                        <div>
                            <p class="font-bold text-amber-900 mb-1 leading-tight text-lg">답변 품질이 만족스럽지 않으신가요?</p>
                            <p class="text-amber-700 text-sm leading-relaxed">
                                AI 모델의 응답이 부족하다면, 설문 내용 전체를 다시 점검해 보세요. 각 항목의 내용을 구체적으로 보강할수록 완성도가 높아집니다. 복사 후에도 입력값은 안전하게 보존됩니다.
                            </p>
                        </div>
                    </div>
                    
                    <button type="button" onclick="generateAndCopy()" class="w-full max-w-sm bg-blue-600 hover:bg-blue-700 text-white font-black text-xl py-6 rounded-2xl shadow-2xl shadow-blue-300 transition-all transform hover:scale-[1.02] active:scale-95 flex items-center justify-center gap-4 mx-auto">
                        <i data-lucide="copy" class="w-6 h-6"></i>
                        프롬프트 복사하기
                    </button>
                    
                    <p class="mt-8 text-sm text-slate-400 italic">복사 성공 시 마법사는 자동으로 첫 번째 단계로 돌아갑니다.</p>
                </div>
            </div>
        </form>
    </main>

    <!-- 하단바 -->
    <footer class="bg-white border-t border-slate-200 p-6 sticky bottom-0 z-50 shadow-lg shadow-slate-100">
        <div class="max-w-4xl mx-auto flex justify-between">
            <button id="prevBtn" onclick="moveStep(-1)" class="px-8 py-4 text-slate-600 font-bold hover:bg-slate-50 rounded-xl flex items-center gap-2 transition-all opacity-0 pointer-events-none">
                <i data-lucide="arrow-left" class="w-5 h-5"></i>
                이전
            </button>
            <button id="nextBtn" onclick="moveStep(1)" class="px-10 py-4 bg-slate-900 text-white font-bold rounded-xl hover:bg-slate-800 flex items-center gap-2 transition-all">
                다음 단계
                <i data-lucide="arrow-right" class="w-5 h-5"></i>
            </button>
        </div>
    </footer>

    <!-- 토스트 알림 -->
    <div id="toast" class="fixed top-24 left-1/2 -translate-x-1/2 bg-slate-900 text-white px-10 py-5 rounded-full opacity-0 translate-y-4 pointer-events-none transition-all duration-500 z-[200] flex items-center gap-4 shadow-2xl border border-slate-700">
        <i data-lucide="check-circle" class="text-green-400 w-6 h-6"></i>
        <span class="font-bold text-lg text-white">프롬프트가 복사되었습니다!</span>
    </div>

    <script>
        let currentStep = 1;
        const totalSteps = 6;
        const STORAGE_KEY = 'prompt_wizard_data';

        lucide.createIcons();

        // 초기화 및 데이터 복구
        window.onload = function() {
            const currentYear = new Date().getFullYear();
            const recencyTextArea = document.getElementById('recencyControl');
            if (recencyTextArea) {
                recencyTextArea.placeholder = `예: ${currentYear}년 이후의 기술 동향을 반영하고 최신 정보를 우선 참고할 것 등`;
            }
            
            loadFromLocal(); // 로컬 데이터 복구
            updateWizardUI();
        };

        // 로컬 저장소에 현재 폼 상태 저장
        function saveToLocal() {
            const data = {
                currentStep: currentStep,
                values: {}
            };
            
            const inputs = document.querySelectorAll('#wizardForm textarea, #wizardForm input[type="checkbox"]');
            inputs.forEach(el => {
                if (el.type === 'checkbox') {
                    data.values[el.id] = el.checked;
                } else {
                    data.values[el.id] = el.value;
                }
            });
            
            localStorage.setItem(STORAGE_KEY, JSON.stringify(data));
        }

        // 로컬 저장소에서 데이터 불러오기
        function loadFromLocal() {
            const savedData = localStorage.getItem(STORAGE_KEY);
            if (!savedData) return;

            try {
                const data = JSON.parse(savedData);
                currentStep = data.currentStep || 1;
                
                if (data.values) {
                    Object.keys(data.values).forEach(id => {
                        const el = document.getElementById(id);
                        if (el) {
                            if (el.type === 'checkbox') {
                                el.checked = data.values[id];
                            } else {
                                el.value = data.values[id];
                            }
                        }
                    });
                }
            } catch (e) {
                console.error('Data restoration failed', e);
            }
        }

        function moveStep(n) {
            currentStep += n;
            if (currentStep < 1) currentStep = 1;
            if (currentStep > totalSteps) currentStep = totalSteps;

            saveToLocal(); // 이동할 때마다 데이터 저장
            updateWizardUI();
            window.scrollTo({ top: 0, behavior: 'smooth' });
        }

        function updateWizardUI() {
            document.querySelectorAll('.wizard-step').forEach((step, idx) => {
                step.classList.toggle('active', (idx + 1) === currentStep);
            });

            const progressPercent = ((currentStep - 1) / (totalSteps - 1)) * 100;
            const progressBar = document.getElementById('progressBar');
            if (progressBar) progressBar.style.width = progressPercent + '%';
            
            const stepIndicator = document.getElementById('stepIndicator');
            if (stepIndicator) stepIndicator.innerText = `Step ${currentStep} of ${totalSteps}`;

            document.querySelectorAll('.progress-dot').forEach((dot, idx) => {
                const stepNum = idx + 1;
                dot.className = 'progress-dot z-10';
                if (stepNum === currentStep) {
                    dot.classList.add('active');
                } else if (stepNum < currentStep) {
                    dot.classList.add('completed');
                } else {
                    dot.classList.add('pending');
                }
            });

            const prevBtn = document.getElementById('prevBtn');
            const nextBtn = document.getElementById('nextBtn');

            if (currentStep === 1) {
                prevBtn.classList.add('opacity-0', 'pointer-events-none');
            } else {
                prevBtn.classList.remove('opacity-0', 'pointer-events-none');
            }

            if (currentStep === totalSteps) {
                nextBtn.classList.add('hidden');
            } else {
                nextBtn.classList.remove('hidden');
                nextBtn.innerHTML = (currentStep === (totalSteps - 1) ? '결과 확인' : '다음 단계') + '<i data-lucide="arrow-right" class="w-5 h-5 ml-2 inline"></i>';
                lucide.createIcons();
            }
        }

        function showModal() { document.getElementById('confirmModal').classList.add('active'); }
        function closeModal() { document.getElementById('confirmModal').classList.remove('active'); }

        // 전체 초기화 및 로컬 데이터 삭제
        function resetWizard() {
            closeModal();
            localStorage.removeItem(STORAGE_KEY); // 로컬 저장소 내용 삭제
            document.getElementById('wizardForm').reset();
            currentStep = 1;
            updateWizardUI();
            window.scrollTo({ top: 0, behavior: 'smooth' });
        }

        function generateAndCopy() {
            const getV = (id) => {
                const el = document.getElementById(id);
                return (el && el.value.trim()) ? el.value.trim() : "Not Provided";
            };
            const getC = (id) => {
                const el = document.getElementById(id);
                return (el && el.checked) ? "Yes, please apply." : "No, skip this.";
            };

            const finalPrompt = `# User Requirements Analysis Survey

## 1. Role and Audience
- Expert Persona: ${getV('persona')}
- Target Audience & Knowledge Level: ${getV('audience')}
- Tone and Manner: ${getV('tone')}

## 2. Goal and Task Definition
- Core Action: ${getV('coreAction')}
- Ultimate Goal / KPI: ${getV('kpi')}
- Workflow Steps & Logic: ${getV('logicalSteps')}

## 3. Background and Constraints
- Contextual Background: ${getV('context')}
- Recency Control: ${getV('recencyControl')}
- Mandatory Rules (Do's & Don'ts): ${getV('constraints')}

## 4. Output Specification
- Format & Required Items: ${getV('outputFormat')}
- Depth and Length Guide: ${getV('outputDepth')}
- Language & Visual Styling: ${getV('visual')}

## 5. Strategy and Advanced Options
- Apply Chain-of-Thought (CoT): ${getC('useCot')}
- Apply Tree of Thoughts (ToT): ${getC('useTot')}
- Include Self-Verification: ${getC('useSelfReview')}

# [Prompt Auto-Execution Command]

"You are the world's best prompt engineer and execution expert. The responses provided in the 'User Requirements Analysis Survey' above are your behavioral guidelines. Strictly follow the contents of each section and perform the task immediately without further clarification questions.

### Execution Guide:
- Synchronize your identity and tone immediately according to the Role section.
- Identify the essence of the problem and derive a solution by combining Background and Task.
- Follow the workflow logic precisely.
- Structure your thinking process using the reasoning techniques specified in the Strategy section.
- Output only the final result cleanly according to the Specification section.

### Run
If you are ready, execute now based on the input data."`;

            const textArea = document.createElement("textarea");
            textArea.value = finalPrompt;
            document.body.appendChild(textArea);
            textArea.select();
            
            try {
                document.execCommand('copy');
                showToast();
                setTimeout(() => {
                    currentStep = 1;
                    saveToLocal(); // 위치 정보 업데이트
                    updateWizardUI();
                    window.scrollTo({ top: 0, behavior: 'smooth' });
                }, 1500);
            } catch (err) {
                console.error('Copy failed');
            }
            document.body.removeChild(textArea);
        }

        function showToast() {
            const toast = document.getElementById('toast');
            if (toast) {
                toast.style.opacity = '1';
                toast.style.transform = 'translate(-50%, 0)';
                setTimeout(() => {
                    toast.style.opacity = '0';
                    toast.style.transform = 'translate(-50%, 1rem)';
                }, 3000);
            }
        }
    </script>
</body>
</html>
